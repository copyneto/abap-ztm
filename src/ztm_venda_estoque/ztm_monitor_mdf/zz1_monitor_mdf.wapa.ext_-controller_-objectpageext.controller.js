sap.ui.define(["sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,s){"use strict";return{onInit:function(e){debugger;this.getOwnerComponent().getModel().resetChanges()},_onObjectMatched:function(e){debugger;var t=this.get+
View().getModel();var s=this.getView().getParent().getBindingContext();detailForm.bindElement({path:s.sPath,parameters:{$$updateGroupId:batchGroupId},events:{dataRequested:()=>this.byId("dynamicPageId").setBusy(true),dataReceived:()=>this.byId("dynamicPa+
geId").setBusy(false)}});dynamicPage=this.getView().byId("dynamicPageId");dynamicPage.bindElement({path:s.sPath})},reset:function(e){this.getOwnerComponent().getModel().resetChanges();this.resetEditingStatus()},resetEditingStatus:function(){const e=this.+
getOwnerComponent().getModel("detailView");e.setProperty("/editing",false,null,true)},onExit:function(e){},onBeforeRendering:function(e){var t=this.getView().getModel();var s=this.getView().getParent().getBindingContext();t.read(s.sPath,{success:function+
(e){if(e.RefOf){this.byId("br.com.trescoracoes.monitormdf::sap.suite.ui.generic.template.ObjectPage.view.Details::MDF--action::onActionNotaFiscalButton").setVisible(false);this.byId("br.com.trescoracoes.monitormdf::sap.suite.ui.generic.template.ObjectPag+
e.view.Details::MDF--action::onActionOrdemFreteButton").setVisible(false)}else{this.byId("br.com.trescoracoes.monitormdf::sap.suite.ui.generic.template.ObjectPage.view.Details::MDF--action::onActionNotaFiscalButton").setVisible(true);this.byId("br.com.tr+
escoracoes.monitormdf::sap.suite.ui.generic.template.ObjectPage.view.Details::MDF--action::onActionOrdemFreteButton").setVisible(true)}}.bind(this),error:function(e){}.bind(this)})},onAfterRendering:function(e){},onActionNotaFiscal:function(e){var t=this+
;var s=e.getSource().getBindingContext().getObject();if(!s.Guid){alert("Opção disponível após salvar o documento");return}var a=new sap.ui.layout.VerticalLayout({width:"100%",content:[new sap.m.Text({text:" "}),new sap.m.Label({text:"Adicionar Notas Fisc+
ais na aba 'Notas Transportadas':"}),new sap.m.MultiInput("inNotaFiscal",{showValueHelp:false})]});var n=new sap.m.Dialog({type:"Message",title:"[+] Chave de Acesso",resizable:true,draggable:true,titleAlignment:sap.m.TitleAlignment.Center,content:a,begin+
Button:new sap.m.Button({type:sap.m.ButtonType.Emphasized,text:"[+] Chave de Acesso",press:function(){var e=sap.ui.getCore().byId("inNotaFiscal").getTokens();var a=e.map(function(e){return e.getKey()}).join(";");n.close();t.onEventAddNotaFiscal(t,s,a)}})+
,endButton:new sap.m.Button({text:"Cancelar",press:function(){n.close()}}),afterClose:function(){n.destroy()}});n.open();var o=sap.ui.getCore().byId("inNotaFiscal");var i=function(e){var t=e.text;return new sap.m.Token({key:t,text:t})};o.addValidator(i)}+
,onEventAddNotaFiscal:function(e,t,s){var a="monitorAdicionarNFSet(Id='"+t.Guid+"',AccessKey='"+s+"')";var n="/sap/opu/odata/SAP/ZTM_MONITOR_MDF_SRV/";var o=new sap.ui.model.odata.ODataModel(n,false);var i=function(){return new Promise(function(t,s){o.re+
ad(a,{success:function(s,a){t();e.oView.getController().extensionAPI.refresh();sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:a.data.Message,persistent:true,type:sap.ui.core.MessageType.Success}))}.bind(this),er+
ror:function(t){s();e.oView.getController().extensionAPI.refresh();let a=[];for(const e of t.response.body.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){a.push(e[1])}let n=[];for(const e of t.response.body.matchAll(/(?:<severity>(.*?)<[/]severity>)/gm)){+
switch(e[1]){case"error":n.push(sap.ui.core.MessageType.Error);break;case"info":n.push(sap.ui.core.MessageType.Information);break;case"success":n.push(sap.ui.core.MessageType.Success);break;case"warning":n.push(sap.ui.core.MessageType.Warning);break;defa+
ult:n.push(sap.ui.core.MessageType.None);break}}for(let e=0;e<a.length;e++){if(a[e]=="Ocorreu uma exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:a[e],persistent:true,type:n[e]}))}}.bind(this)}+
)}.bind(this))}.bind(this);this.extensionAPI.securedExecution(i,{busy:{set:true,check:false},sActionLabel:"Mensagens"})},showSuccessMessage:function(e){this.getView().setBusy(false)},showErrorMessage:function(e){this.getView().setBusy(false)},onActionOrd+
emFrete:function(e){var t=this;var s=e.getSource().getBindingContext().getObject();if(!s.Guid){alert("Opção disponível após salvar o documento");return}var a=new sap.ui.layout.VerticalLayout({width:"100%",content:[new sap.m.Text({text:" "}),new sap.m.Lab+
el({text:"Adicionar Ordens de Frete na aba 'Notas Transportadas':"}),new sap.m.MultiInput("inOrdemFrete",{showValueHelp:false})]});var n=new sap.m.Dialog({type:"Message",title:"[+] Ordem Frete",resizable:true,draggable:true,titleAlignment:sap.m.TitleAlig+
nment.Center,content:a,beginButton:new sap.m.Button({type:sap.m.ButtonType.Emphasized,text:"[+] Ordem Frete",press:function(){var e=sap.ui.getCore().byId("inOrdemFrete").getTokens();var a=e.map(function(e){return e.getKey()}).join(";");n.close();t.onEven+
tAddOrdemFrete(t,s,a)}}),endButton:new sap.m.Button({text:"Cancelar",press:function(){n.close()}}),afterClose:function(){n.destroy()}});n.open();var o=sap.ui.getCore().byId("inOrdemFrete");var i=function(e){var t=e.text;return new sap.m.Token({key:t,text+
:t})};o.addValidator(i)},onEventAddOrdemFrete:function(e,t,s){var a="monitorAdicionarOFSet(Id='"+t.Guid+"',OrdemFrete='"+s+"')";var n="/sap/opu/odata/SAP/ZTM_MONITOR_MDF_SRV/";var o=new sap.ui.model.odata.ODataModel(n,false);var i=function(){return new P+
romise(function(t,s){o.read(a,{success:function(s,a){t();e.oView.getController().extensionAPI.refresh();sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:a.data.Message,persistent:true,type:sap.ui.core.MessageType.+
Success}))}.bind(this),error:function(t){s();e.oView.getController().extensionAPI.refresh();let a=[];for(const e of t.response.body.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){a.push(e[1])}let n=[];for(const e of t.response.body.matchAll(/(?:<severity>+
(.*?)<[/]severity>)/gm)){switch(e[1]){case"error":n.push(sap.ui.core.MessageType.Error);break;case"info":n.push(sap.ui.core.MessageType.Information);break;case"success":n.push(sap.ui.core.MessageType.Success);break;case"warning":n.push(sap.ui.core.Messag+
eType.Warning);break;default:n.push(sap.ui.core.MessageType.None);break}}for(let e=0;e<a.length;e++){if(a[e]=="Ocorreu uma exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:a[e],persistent:true,t+
ype:n[e]}))}}.bind(this)})}.bind(this))}.bind(this);this.extensionAPI.securedExecution(i,{busy:{set:true,check:false},sActionLabel:"Mensagens"})},onActionPrint:function(e){let t=e.getSource().getBindingContext();var s="/sap/opu/odata/SAP/ZTM_MONITOR_MDF_+
SRV/";if(t.getObject().StatusCode=="100"){var a=t.getObject().Guid.toString().replaceAll("-","").toUpperCase()+";"}else{var a=""}if(!a){alert("Somente é possivel imprimir MDF-e autorizada.");return}var n=s+"downloadSet(Id='"+a+"')/$value";var o=new sap.m+
.PDFViewer;this.getView().addDependent(o);o.setSource(n);o.setTitle("Fomulário");o.open()}}});                                                                                                                                                                 