sap.ui.define(["sap/base/util/uid"],function(e){"use strict";return{onActionProcessar:function(e){let t=this.templateBaseExtension.getExtensionAPI().getSelectedContexts();if(!t.length){sap.m.MessageToast.show("Nenhum registro gerado. Operação cancelada."+
);return}if(t.length>1){alert("Favor selecionar apenas um registro");return}let s=t[0].getObject().FreightOrderUUID.toString().replaceAll("-","").toUpperCase();let a=t[0].getObject().FreightUnitUUID.toString().replaceAll("-","").toUpperCase();var r="chec+
kAuthoritySet(FreightOrderUUID='"+s+"',FreightUnitUUID='"+a+"')";var o="/sap/opu/odata/SAP/ZTM_PRESTACAO_CONTAS_SRV/";var n=new sap.ui.model.odata.ODataModel(o,false);var i=function(){return new Promise(function(e,t){n.read(r,{success:function(t,a){e();s+
ap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported([{target:{shellHash:"FreightOrder-changeRoad"}}]).done(function(e){e.map(function(e,t){if(e.supported===true){var a=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.+
getService("CrossApplicationNavigation").hrefForExternal({target:{semanticObject:"FreightOrder",action:"changeRoad"},params:{key:s}});sap.m.URLHelper.redirect(a,false)}else{alert("Usuário sem permissão para acessar o link")}})}).fail(function(){alert("Fa+
lha ao acessar o link")})}.bind(this),error:function(e){t();let s=[];for(const t of e.response.body.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){s.push(t[1])}let a=[];for(const t of e.response.body.matchAll(/(?:<severity>(.*?)<[/]severity>)/gm)){switch(+
t[1]){case"error":a.push(sap.ui.core.MessageType.Error);break;case"info":a.push(sap.ui.core.MessageType.Information);break;case"success":a.push(sap.ui.core.MessageType.Success);break;case"warning":a.push(sap.ui.core.MessageType.Warning);break;default:a.p+
ush(sap.ui.core.MessageType.None);break}}for(let e=0;e<s.length;e++){if(s[e]=="Ocorreu uma exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:s[e],persistent:true,type:a[e]}))}}.bind(this)})}.bind+
(this))}.bind(this);this.extensionAPI.securedExecution(i,{busy:{set:true,check:false},sActionLabel:"Mensagens"})},showSuccessMessage:function(e){this.getView().setBusy(false)},showErrorMessage:function(e){this.getView().setBusy(false)},onActionPrint:func+
tion(e){let t=this.templateBaseExtension.getExtensionAPI().getSelectedContexts();if(!t.length){sap.m.MessageToast.show("Nenhum registro gerado. Operação cancelada.");return}if(t.length>1){alert("Favor selecionar apenas um registro");return}var s="/sap/op+
u/odata/sap/ZUI_O2_TM_PRESTACAO_PRINT";var a=new sap.ui.model.odata.ODataModel(s,false);a.read("/ZI_TM_VH_PRINT_STATUS",{success:function(e){this.printForm(e.results)}.bind(this),error:function(e){alert("Falha ao recuperar os formulários de impressão")}.+
bind(this)})},printForm:function(e){var t=this;var s=new sap.m.ComboBox({id:"oComboBox",items:{path:"/items",template:new sap.ui.core.ListItem({key:"{PrintName}",text:"{PrintText}",additionalText:"{PrintName}"}),templateShareable:false},showSecondaryValu+
es:true});s.setModel(new sap.ui.model.json.JSONModel({items:e}));var a=new sap.ui.layout.VerticalLayout({width:"100%",content:[new sap.m.Text({text:"Selecione o tipo de formulário desejado"}),new sap.m.Text({text:" "}),s]});var r=new sap.m.Button({type:s+
ap.m.ButtonType.Emphasized,text:"Imprimir",press:function(){var e=sap.ui.getCore().byId("oComboBox").getSelectedKey();if(!e){alert("Escolher um formulário antes de prosseguir")}else{n.close();t.downloadForm(e)}}});var o=new sap.m.Button({text:"Cancelar",+
type:"Reject",press:function(){n.close();n.destroy();this.getView().removeAllDependents()}.bind(this)});var n=new sap.m.Dialog({type:"Message",title:"Saída de impressão",resizable:true,draggable:true,titleAlignment:sap.m.TitleAlignment.Center,content:a,b+
eginButton:r,endButton:o,afterClose:function(){n.destroy()},contentWidth:"20%"});n.open()},downloadForm:function(e){let t=this.templateBaseExtension.getExtensionAPI().getSelectedContexts();let s=t[0].getObject().FreightOrderUUID.toString().replaceAll("-"+
,"").toUpperCase();let a=t[0].getObject().FreightUnitUUID.toString().replaceAll("-","").toUpperCase();let r=e.toString().replaceAll("/",".");var o="/sap/opu/odata/SAP/ZTM_PRESTACAO_CONTAS_SRV/";var n=o+"downloadSet(FreightOrderUUID='"+s+"',FreightUnitUUI+
D='"+a+"',PrintName='"+r+"')/$value";var i=new sap.m.PDFViewer;this.getView().addDependent(i);i.setSource(n);i.setTitle("Fomulário");i.open()}}});                                                                                                             